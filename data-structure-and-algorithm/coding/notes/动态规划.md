# 动态规划

动态规划问题解决步骤：

1. 设计暴力递归（递归尝试），通过**重要原则**和 **4 种常见尝试模型**去得到好的递归尝试（最关键的一步，没有套路，只有自然智慧）；

2. 分析有没有重复解，指定样本，套递归过程，就可以发现有没有重复解（套路解决）；

3. 用记忆化搜索去掉缓存（傻缓存，没有迭代行为已经是最优解了，有迭代行为还需使用严格表结构去除迭代行为）；

4. 用严格表结构实现动态规划（套路解决）；


## 递归尝试

某一个暴力递归，有解的重复调用，就可以把这个暴力递归优化成动态规划。任何动态规划问题，都一定对应着某一个有重复过程的暴力递归，但不是所有的暴力递归，都一定对应着动态规划。

有重复调用同一个子问题的解，这种递归可以优化，如果每一个子问题都是不同的解，无法优化也不用优化。

解决一个问题，可能有很多尝试方法；可能在很多尝试方法中，又有若干个尝试方法有动态规划的方式；所以一个问题可能有若干种动态规划的解法。

所以解决动态规划第一步，设计暴力递归。

### 递归尝试设计原则

设计的原则如下：

1. 设计递归函数时，每一个可变参数的类型，一定不要比 int 类型更加复杂；
2. 原则 1，可以违反，让类型突破到一维线性结构，那必须是单一可变参数；
3. 如果发现原则 1 被违反，但不违反原则 2，只需要做到记忆化搜索即可，比如贴纸问题；
4. 可变参数的个数，能少则少。

如果设计的暴力递归不符合上述原则，直接推到这种设想，重新设计递归函数。

### 递归尝试模型

设计递归有 4 中尝试模型

- 从左往右的尝试模型
- 范围上的尝试模型
- 多样本位置全对应的尝试模型
- 寻找业务限制的尝试模型

### 递归尝试步骤

- 一定要逼自己找到不违反原则情况下的暴力尝试！

- 如果你找到的暴力尝试，不符合原则，马上推到重来！

- 如果某个题目突破了设计原则，一定极难极难，面试中出现概率低于 5%！
- 没有设计递归的思路，怎么办？通过 4 中尝试模型去思考，看问题的描述贴近于那种模型，按照模型的套路就能容易的设计出暴力递归。

## 记忆化搜索优化

如果递归的过程中存在重复的调用过程，那么最简单的我们可以使用记忆化搜索优化。

缓存表可以用数组，也可以用 Map，数组下标的设计和 Map 的 key 的设计根据递归函数的可变参数来决定。

简单来讲就是通过缓存记录某些子递归的调用过程，每次递归时先尝试从缓存中获取结果，如果获取不到再走递归逻辑，最后别忘了将递归结果放到缓存中。

## 严格递推优化

更好的方式是使用严格递推优化，可以得到更好的常数项时间。

具体步骤为：

- 根据可变参数设计 dp 表的维度和容量，知晓 `dp[i][j]` 表达含义；

  > 这里也说明了为什么在递归尝试是可变参数一定不要突破整型，因为如果突破了，这里的 dp 表的维度和容量将难以设计。

- 根据递归分析 dp 表值的依赖关系和 dp 最终返回值的位置；

- 根据递归的 base case 填充好 dp 表中能够填充的边界值；

- 根据递归代码，填充 dp 表；

- 返回 dp 表对应位置的值；

- 对于有枚举行为的决策过程，在 dp 表的填充过程中可以发现规律，可尝试去除枚举行为。

在构建 dp 表的时候，如果递归有迭代行为，

## 动态规划的进一步优化

- 空间压缩；

- 状态化简；

- 四边形不等式；

- 其他优化技巧，比如在不影响结果的前提下根据业务（题目要求）改造样本，使得算法代价更低（这个不光是动态规划可以用，其他算法类型的题目也可以用。而且有的问题必须要修改样本，才能够更容易解决）。

  





