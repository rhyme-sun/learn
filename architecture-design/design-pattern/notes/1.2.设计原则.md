# 设计原则

设计原则。

## 单一职责原则

一个类，应当只有一个引起它变化的原因，即一个类应该只有一个职责。

该原则对对象职责提出了一种理想期望。对象不应该承担太多职责，这样才能保证对象的细粒度，高内聚。对象的高内聚与细粒度更有利于对象的重用。如果一个对象承担了太多的责任，当客户端需要对象的某一个职责时，就不得不将所有职责包含进来，对使用不友好，且存在冗余。

## 里式替换原则

所有应用基类的地方必须能透明的使用其子类对象，替换成子类不会是程序产生任何错误或异常，但是反过来则不可以，有子类的地方，父类未必能适应。

在面向对象语言中，继承是必不可少的特性，它的优点是：代码复用，每个子类都拥有父类的方法和属性，提高了代码的可重用性。同时继承也有缺陷，继承是入侵式的，只要继承，子类就必须拥有父类的属性和方法，使得子类受到限制；继承层次过多不利于代码的维护和扩展。

里式替换原则指导继承的设计，可以充分发挥继承的好处，同时减少继承弊端带来的影响。其要求父类里面的属性和方法都是需要被子类共同用到的，这样避免了子类被强迫拥有其不需要的方法和属性，使得了类之间的继承关系更加内聚。

## 依赖倒置原则

依赖倒置原则包含三种含义：

- 高层模块不应该依赖底层模块，两者都依赖其抽象；
- 抽象不依赖细节；
- 细节应该依赖抽象。

传统的过程性系统设置倾向于高层次的模块依赖低层次的模块，抽象层次依赖具体层次。“倒置”就是将这种依赖关系翻转了过来，由此命名为“依赖倒置原则”。

在 Java 语言层面，抽象表现为抽象类和接口，二者都是不能被实例化的；细节就是具体的实现类，实现类会实现接口或继承抽象类，其特点是可以被直接实例化。依赖倒置原则在 Java 语言中的表现是：

- 模块间依赖通过抽象产生，实现类之间不发生直接的依赖关系，其依赖关系是通过接口或抽象类产生；
- 接口或抽象类不依赖与实现类；
- 实现类依赖接口或抽象类。

依赖倒置原则就是“面向接口编程”——OOD 的精髓之一。依赖倒置原则可以减少类之间的耦合性，强调依赖稳定的接口而非不稳定的实现。从而提高系统的稳定性，降低并行协作开发引起的风险。

## 接口隔离原则

接口隔离原则有如下定义：

- 客户端不应该依赖其不需要的接口；
- 类间的依赖关系应该建立在最小接口上。

接口隔离原则具体的含义如下：

- 一个类对另外一个类的依赖应当建立在最小的接口上；
- 一个接口代表一个角色，不应当将不同的角色都交给同一个接口（接口的单一职责），臃肿的接口是对角色和接口的污染；
- 不应该强迫客户端依赖其不用的方法。接口属于客户，不属于它所在类的的层次结构，不要强迫客户使用他们不用的方法，否则这些客户就面临由于这些不使用的方法的改变所来带的改变。

接口隔离原则使得接口的设计更加内聚，和实现类的关系更加内聚。

## 迪米特法则

迪米特法则又称最少知识原则，意思是一个对象应当对其他对象尽可能少的了解。迪米特法则有下面几种表述：

- 直与你的**直接朋友**通信；
- 不要和“陌生人”说话；
- 每个软件单位对其他单位都只有最少的了解，这些了解仅局限于那些与本单位密切先关的软件单位。

按照迪米特法则，如果两个类不必彼此直接通信，那么这两个类就不应当发生直接的相互作用；如果一个类需要调用另一个类的某个方法，可以通过第三者转发这个调用。迪米特法则是希望减少类之间的耦合，让类越独立越好。每个类都应该少了解系统的其他部分，这样一旦发生变化，受到影响而需要改变的类就少。

## 开闭原则

开闭原则的定义是，一个软件实体应该**对扩展开放，对修改关闭**。这个原则说明，在设计一个模块的时候，应当使这个模块可以在不被修改的前提下被扩展，即应当可以在不必修改源代码的情况下扩展这个模块的行为。

在面向对象编程中，开闭原则是最基础的原则，起到总的指导作用。其他原则（单一职责、里式替换、依赖倒置、接口隔离、迪米特法则）都是开闭原则的具体形态。开闭原则的重要性体现在以下几个方面：

- 开闭原则提高复用性。在面向对象设计中，所有的逻辑都是从原子逻辑组合而来，而不是在一个类中独立实现一个业务逻辑。代码粒度越小，被复用的可能性就越大。开闭原则的设计保证了系统是一个在高层次实现了复用的系统。
- 开闭原则可提高可维护性。一个软件投产后，维护人员的工作不仅是对数据的维护，还可以是对程序的扩展，就是扩展一个类，而不需要修改类。开闭原则对已有模块，特别是对最重要的模块要求不再修改，这就是使变化中的软件系统有一定的稳定性和延续性，便于系统维护。
- 开闭原则提高灵活性。所有的软件都有一个共同的性质，即对系统的需求都会随着时间的推移而发生变化。在软件系统面临新的需求是，系统的设计必须是稳定的。开闭原则可以通过扩展已有的软件系统，提供新的行为，使得系统能够适应需求的变化。
- 开闭原则易于测试。测试是软件开发过程中必不可少的一个环节。测试不仅要保证逻辑的正确性，还要保证苛刻条件（高压力，边界条件）下不产生“有毒代码”。因此当有变化提出时，原有的健壮的代码尽量不要修改，而是通过扩展来实现。否则就需要将相关的测试全部重写测一遍，需要进行单元测试、功能测试、甚至是验收测试。开闭原则的使用，保证软件是用扩展来实现业务逻辑的变化，而不是修改。因此对于新增的类，只需要新增新的测试类，编写对应的测试方法，保证新增的类是正确的就可以了。