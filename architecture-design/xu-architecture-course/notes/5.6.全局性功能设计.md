# 全局性功能设计

原文链接：[61 | 全局性功能的架构设计 (geekbang.org)](https://time.geekbang.org/column/article/173619)

在架构设计中，我们会有一些难啃的骨头。其中最为典型的，就是全局性功能。正因为需求交织在一起，全局性功能往往难以彻底进行正交分解，很难被剥离出来成为独立模块的。但对于架构师来说，难不代表应该轻易就放弃对正交分解的追求。



全局性的功能可以简单理解为每个子系统都可能体现的功能，不好去正交分解。

## 读盘 / 存盘功能



## Undo/Redo 功能



## 宏录制功能

所谓宏（Macro），是指二次开发的代码。微软几乎所有的产品都有二次开发接口，也就是 API 层，典型代表是 Office 和 Visual Studio。

有了二次开发接口，就可以有生态，有围绕着 Office 和 Visual Studio 的生态厂商，来增强产品的能力，也可以让 Office 和 Visual Studio 更容易地融入到企业的业务流中。

那么什么是 “宏录制”？简单说，就是把用户的界面操作用 API 调用的方式记录下来，把它变成一段二次开发代码。



## 架构师的信仰

我们需要坚定的一个信念是，任何功能都是可以正交分解的，即使我目前还没有找到方法，那也是因为我还没有透彻理解需求。

换句话说，怎么做业务分解？业务分解就是最小化的核心系统，加上多个正交分解的周边系统。核心系统一定要最小化，要稳定。坚持不要往核心系统中增加新功能，这样你的业务架构就不可能有臭味。

在模块演化的过程中，随着功能的增加，复杂模块的演化可能会经历剧烈的调整期。通常这种剧烈调整起源于需求理解的进一步深化，引发对原模块接口的反思。无论如何，记住最重要的一点：**保持核心系统的纯洁性比什么都重要**。



## 结语

架构分解中有两大难题。

- 其一，需求的交织。不同需求混杂在一起，也就是我们今天说的**全局性功能**。
- 其二，需求的易变。不同客户，不同场景下需求看起来很不一样，场景呈发散趋势。