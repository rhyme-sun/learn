# CyclicBarrier

和 CountDownLatch  一样，CyclicBarrier 也是 JUC 提供的协调线程同步的工具类。不同的是 CountDownLatch 用来使一个线程等待其他线程执行完毕，而CyclicBarrier 是一组线程之间互相等待。

## 一组线程相互等待

如下代码所示：

```java
public static void main(String[] args) {
    int parties = 20;
    Runnable barrierAction = () -> System.out.println("Go");
    CyclicBarrier barrier = new CyclicBarrier(parties, barrierAction);

    int total = 100;
    Runnable task = () -> {
        try {
            // 等待，直到等待数量达到指定的 parties，运行指定的 barrierAction。
            barrier.await();
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (BrokenBarrierException e) {
            e.printStackTrace();
        }
    };
    for (int i = 0; i < total; i++) {
        new Thread(task).start();
    }
}
```

CyclicBarrier 是一组线程之间互相等待，在创建 CyclicBarrier 时，我们会指定 CyclicBarrier 计数器的数量和一个回调函数，当计数器到达指定数量时，执行回调方法里的逻辑。除此之外，CyclicBarrier 计数器是可以重用的，当执行完一轮的回调逻辑后，计数器会重新开始计数。