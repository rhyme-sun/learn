# 进程、线程和协程

进程是计算机中运行的程序，是一个动态的概念，进程也作为操作系统分配资源的基本单位；线程是一个程序的不同执行路径，作为操作系统调度的基本单位；协程是一种用户态的轻量级线程，协程之间的切换不需要涉及任何系统调用或任何阻塞调用，切换效率高。

## 进程

**进程（process）**是指计算机中运行的程序，是一个动态的概念。比如，在 Java 程序中，当我们启动 main 函数时其实就是启动了一个 JVM 实例进程，而 main 函数所在的线程就是这个进程中的一个线程，也称主线程。

**程序**本身只是指令、数据及其组织形式的描述，是一个静态的概念，进程才是指令和数据的真正运行实例。

## 线程

**线程（thread）**是操作系统能够进行运算调度的最小单位，大部分情况下，它被包含在进程内，是进程中实际运作的单位。

同一进程中的多个线程将共享进程中的全部系统资源，如虚拟地址空间，文件描述符等等；但这些线程同时又有各自的调用栈，自己的寄存环境，自己的线程本地存储。

>  注：在早期面向进程设计的系统中，进程是程序的基本执行实体；在面向线程设计的系统中，进程本身不是基本运行单位，而是线程的容器。
>

Java 程序就是多线程程序，我们可以在一个 JVM 实例进程中创建多个线程，这些线程共享了 JVM 实例的堆内存和方法区，同时又有线程私有的栈区域，程序程序计数器。



进程与线程的区别：

进程是程序的运行状态，线程是一个进程中不同的执行路径，一个进程可以包含若干个线程。进程是操作系统用来分配资源的基本单位，线程是操作系统调度的基本单位。

## 协程

**协程**（coroutine）是计算机程序的一类组件，推广了协作式多任务的子程序，允许执行被挂起与被恢复。

> **协作式多任务（Cooperative Multitasking）**和**抢占式多任务（Preemption）**是计算机操作系统两种多任务方式（多任务是使电脑能同时处理多个程序的技术）。协作式多任务要求每一个运行中的程序，定时放弃自己的运行权利，告知操作系统可让下一个程序运行；抢占式多任务则是由操作系统完全决定进程调度方案，操作系统可以剥夺耗时长的进程的时间片，提供给其它进程。

Java 原生没有实现对协程的支持，但我们可以使用一些类库来使用协程，比如 [**quasar**](https://github.com/puniverse/quasar)、[**coroutines**](https://github.com/offbynull/coroutines)、[**kilim** ](https://github.com/kilim/kilim)等。



线程与协程的区别：

协程非常类似于线程，但协程是协作式多任务的，而线程的调度有协作式的和抢占式的。协程超过线程的好处是它们适合用于即时计算的场景，这是因为相对于线程，在协程之间的切换不需要涉及任何系统调用或任何阻塞调用，切换效率高。协程是语言层级的，而线程是系统层级的。

## 总结

### 参考链接

- [多线程基础 - 廖雪峰的官方网站 (liaoxuefeng.com)](https://www.liaoxuefeng.com/wiki/1252599548343744/1304521607217185)
- [进程 - 维基百科，自由的百科全书 (wikipedia.org)](https://zh.wikipedia.org/wiki/行程)
- [线程 - 维基百科，自由的百科全书 (wikipedia.org)](https://zh.wikipedia.org/wiki/线程)
- [协程 - 维基百科，自由的百科全书 (wikipedia.org)](https://zh.wikipedia.org/wiki/协程)