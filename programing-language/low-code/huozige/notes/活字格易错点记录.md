# 活字格易错点记录





## 活字格的数据类型

[Excel中的数据类型 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/158540250)





### 易错点记录

记录一些容易出错，或者需要进一步理解才能够更好使用的点。

#### 值判断

Excel 在默认情况下单元格格式都是“常规”，需要说明的是“常规”格式并不是一种特定的数据类型格式，它是一种可变类型。它是指 Excel 会根据用户向单元格中输入的内容，自动判断数据类型。活字格中也有常规类型，规则和 Excel 一致。



活字格单元格类型的默认值（不设值）都是数字 0。

不同单元格数字判断：

- 常规：值为数字
- 文本框：值为文本，判断要加引号
- 数字框：值为数字
- 引用常规（公式）：值为数字
- 引用文本（公式）：值为文本
- 引用数字（公式）：值为数字

单元格的值为公式时，即上述的引用，值的类型和公式计算的结果有关，这时候和单元格的类型无关。



#### 操作 JSON

使用场景：

一些命令的命令返回结果

获取，修改 JSON 属性。



利用返回命令将表数据转 JSON：

[【新提醒】8.0.4.0导出表格中选中的行数据 - 活字格专区 - 求助中心 - 葡萄城产品技术社区 (grapecity.com.cn)](https://gcdn.grapecity.com.cn/forum.php?mod=viewthread&tid=151367)



表格转 JSON

[【新提醒】数据表导出为json格式 - 活字格专区 - 求助中心 - 葡萄城产品技术社区 (grapecity.com.cn)](https://gcdn.grapecity.com.cn/forum.php?mod=viewthread&tid=133014&fromuid=63496)



### 操作数组

[服务端命令循环命令中是否支持使用下标取值？ - 活字格专区 - 求助中心 - 葡萄城产品技术社区 (grapecity.com.cn)](https://gcdn.grapecity.com.cn/forum.php?mod=viewthread&tid=97531&extra=)



### 浮点误差

[看完必恍然大悟的活字格内幕：三十二、如何处理浮点误差 - 活字格专区 - 专题教程 - 葡萄城产品技术社区 (grapecity.com.cn)](https://gcdn.grapecity.com.cn/forum.php?mod=viewthread&tid=57855&extra=page%3D3%26filter%3Dtypeid%26typeid%3D242)

浮点误差出现原因，小数二进制浮点数转成十进制小数时会出现误差。

解决办法，利用公式字段，先将小数转换成整数，比如乘 100，然后再除 100，跳过浮点数小数二进制转成十进制可能出现的精度丢失问题。
