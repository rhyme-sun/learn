# 活字格类 Excel 操作

活字格设计器界面和 Excel 类似，有些概念也类似。这里总结一些活字格和 Excel 类似的操作，并试图从 Excel 的一些原理来解释活字格的相关操作。

> 这里多会从 Excel 的角度描述一些行为，如果没有特殊说明，这些行为在活字格设计器会有一样的效果。

## Alt 键

Excel 按住 Alt 键可以显示快捷键，再次按对应按键就会跳转到对应菜单，使用快捷键会省去点击鼠标的操作。

活字格中也有同样操作，按下 Alt 键，再按下 Alt + 对应快捷键就能跳转到对应菜单。



 ## 数据类型

原文链接：[2.1 Excel中的数据类型 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/158540250)

### 数值

数字与数值是二个不同的概念，数字是一种用来表示数的书写符号（英文字母，汉字也是书写符号），如阿拉拍数字 0 至 9 就是数字、中文大写的”一”、“二”、“三“ 也是数字。而数值则是表示某种对象的数量，例如金额、销售额、人数、成绩等。数值最大的特性就是可用来进行数学计算，例如进行加、减、乘、除等计算。**数值是数字的一种计算特性**。在 Excel 中数字分为两种：**文本型数字**与**数值型数字**。

- 文本型数字：比如手机、身份证号码，文本类数字用来用数字符号表示一个事物的名称、编号、代码，不就有数学上面的运算意义。

- 数值型数字：具有数学上的含义，可以参与数学计算。

Excel 中的数值最大可精确到 15 位数，如果输入很大的值，如 430623201810251234（18位）， 则 Excel 实际上只会存储 15 位精度的数字，15 位数后面的数字234 ，Excel 会自动变成 0，此操作会以不可逆的方式影响数值的真实精度。

> 注意：输入数值 430623201810251234，因该数值较大 Excel 自动采用科学计数表示，科学记数法表示为 4.30623E+17，即 4.30623 x 10^17，E 代表 10 的乘方。



**常规**类型：

Excel 在默认情况下单元格格式都是“常规”，需要说明的是“常规”格式并不是一种特定的数据类型格式，它是一种可变类型。它是指 Excel 会根据用户向单元格中输入的内容，自动判断数据类型。

如，用户在“常规”格式下的单元格中输入“123”，Excel 会自动识别为数值类型，如输入“2020-10-25”，Excel 会自动将其识别为日期类型。如果输入“Hello!”，Excel 则会自动识别为文本字符串类型。

如果用户把身份证号码在“常规”格式下的单元格中直接输入，Excel 会将身份证号码自动识别为数值，正因为是数值，所以 Excel 将超过 15 位的数字将自动变成 0，此举输入的身份证号必然是错误的，当用户输入身份证号码（18 位）时，为了正确、完整的显示身份证号码数字，必须要采用文本形式保存身份证号码。

在默认情况下，文本型数字及文本在单元格中是靠左对齐，而数值型数字靠右对齐。



日期和时间：

在 Excel 中，日期和时间本质是数值序列，即日期和时间是以一种特殊的数值形式存储在单元格中的。日期为 1 到 2958465 之间的数值。Excel 软件开发者这样设计，其目的就是让日期时间可以像普通数值一样能被计算。

在 Windows 操作系统上的 Excel 版本中，日期系统默认为 “1900 年日期系统”，即 1900 年 1 月 1 日作为日期序列值的起始日，1900/1/1 的序列值为 1，1900/1/1 的序列值为 2，依次类推。

> 活字格 1 对应日期为 1899-12-31，那么是不是相同的数值序列在活字格看都会比 Excel 晚一天呢？不是的。
>
> 实际上从 61（1900-3-1）这个序列之后活字格和 Excel 会得到统一的结果。原因在于，这是 Excel 的一个 bug，Excel 认为 1900 年是闰年，因此 2 月有 29 天，如果你在 Excel 输入数字 60，并将其格式改为日期，就会得到 1900-2-29。活字格让 1 对应 1899/12/31 号，避免了这个 bug，并且 60 之后的时间序列和 Excel 具有相同的行为。关于 Excel bug 的详细信息可以查看：[Microsoft Excel 的陈年旧 bug (azaleasays.com)](https://azaleasays.com/2017/01/22/30-year-old-bug-in-microsoft-excel/)。
>
> 还有一点不同的是，Excel 时间序列范围为 1~2958465，即从 1900/1/1 到 9999/12/31。活字格序列范围为： -657435~2958465，即从 0100/1/1 到 9999/12/31。



日期和数值对照表：

|                    | 数值表示       | 结果值  |
| ------------------ | -------------- | ------- |
| 天                 | 1              | 1       |
| 半天（中午 12 点） | 1/2            | 0.5     |
| 1 小时             | 1/24           | 0.04166 |
| 1 分钟             | `1/(24*60)`    | 0.00069 |
| 1 秒钟             | `1/(24*60*60)` | 0.00001 |

时间序列值可以由小数，整数部分所表示的日期与小数部分表示的时间结合，即组成一个日期及时间序列值。例如 2020/10/25 12:00:00 的序列值为 44129.5。

由于日期及时间本质为数值，因此日期与时间具有数值所有运算的功能，例如要计算 2020/10/1 与 2020/10/25 相差多少天，可直接将两日期相减便可求出相差天数。

### 文本

文本通常是指一些非数值性的文字、符号等，例如公司名称、姓名、部门等，对于不代表数量、不需要进行数值计算的数字可以用文本形式存储，例如身份证号码、银行账号、电话号码等。此外Excel将错误的日期时间、非正确的公式结构、文本型数字都识为文本。对于文本性质的单元格，用户输入的内容会完整的显示。

文本对齐控制：

[Excel为什么在数字前加单引号（'）会将数字转为文本格式？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/425348468/answer/1520622419)

### 公式

公式通常都是以等号“=”开头，用于计算的表达式。当用户在单元格内输入公式并确认后，会在单元格内立即显示公式的运算结果。更改公式所引用的任何单元格内容，公式的结果会自动重新计算并显示新的结果。公式可以是简单的数学表达式，也可以是 Excel 的内置函数，甚至是用户自定义的函数。

### 逻辑值

逻辑值是判断某个逻辑表达式是真还是假的结果（如“5>3”就是一个逻辑表达式），逻辑值有且只有两种结果：真或假（成立和不成立）。成立的时候逻辑值为真，使用 TRUE、1、或非 0 数字表示，不成立的时候逻辑值为假，使用 FALSE 或 0 表示。对于一般关系运算符（>、<、<=、>=）的结果、逻辑运算符的结果都是逻辑值。

在 Excel 公式函数中，逻辑表达式常被作于参数。公式函数先判断逻辑表达式的真或假，然后再根据真或假做进一步的计算或是返回真或假相对应的结果值。

### 错误值

当公式不能计算正确结果时，单元格中将显示一个错误值，例如 #N/A!、#DIV/0! 等。

## 设置数据格式

[5.1 数字格式设置介绍 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/158731150)

[5.2 设置数字格式 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/158731643)

默认情况下，用户输入的数值都是一组数字组成的数字串，此数字串未经格式化，无法直观地告诉用户数字背后的具体意义。设置数字格式是指更改数据在单元格中外观显示。对数字进行格式化可以快速提升工作表的外观表现力和易读性。

**设置数字格式，只会改变数值在单元格中的外观显示，绝对不会改变单元格中数据的实际值**，查看某单元格实际的值，需要选中该单元格，然后**在编辑栏中可以查看该单元格中的实际值，在单元显示的为显示值**，在 Excel 公式计算中都是以实际值参与运算的。

[5.3 文本型数字与数值型数字 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/158736582)



默认情况下，在 Excel 空单元格的值为数值 0。可以用 TYPE 函数来查看单元格值的类型，数值-1，文字-2，逻辑值-4，错误值-16，数组-64。



### 自定义格式

[EXCEL单元格格式自定义全面解读 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/148013721)



## 条件格式

[珍藏，最全面+最完善的Excel条件格式使用手册 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/30759475)

条件格式是 Excel 中很强大的功能，它可以根据单元格值来设置匹配规则，并为匹配上单元格设置自定义格式，到达醒目展示数据的效果。

上面链接介绍了条件格式的使用场景和方法。和 Excel 不同的是，活字格的条件格式可以设置单元格是否可见、是否禁用、是否只读。

