# 活字格命令

在活字格中，命令是非常重要的功能，它用来执行业务，比如单击一个按钮进行页面跳转、弹出或是提交数据到数据库。

在命令窗口可新建多条命令，这些命令会按顺序依次执行。也可以对命令进行删除、上移、下移、插入、复制、禁用操作。

## 页面加载时命令和单元格命令

单元格命令用着单元格状态改变时触发，页面加载命令则在页面每次加载后触发。页面加载命令可以看做是对单元格命令的补充。

具体例子可看：[页面加载时命令和普通命令混淆 - 活字格专区 - 专题教程 - 葡萄城产品技术社区 (grapecity.com.cn)](https://gcdn.grapecity.com.cn/forum.php?mod=viewthread&tid=38127&extra=page%3D3)

## 单元格命令

### 操作单元格命令

[操作单元格命令 - 活字格V8帮助手册 - 葡萄城产品文档中心 (grapecity.com.cn)](https://help.grapecity.com.cn/pages/viewpage.action?pageId=72368079)

不同的单元格类型有不同的操作。使用操作单元格命令，当您选择一个目标单元格类型时，该单元格可用的操作会被列出，您可以查看此目标单元格支持的操作，并根据您的实际业务需要来选择使用的操作。

### 设置单元格属性

在活字格中，可以使用设置变量命令来设置变量，变量的值可以为值、公式，或是来自数据库。

[单元格命令-设置单元格属性 - 活字格V8帮助手册 - 葡萄城产品文档中心 (grapecity.com.cn)](https://help.grapecity.com.cn/pages/viewpage.action?pageId=72354393)

使用场景，动态控制页面元素样式（比如动态控制页面元素是否可见）。

图片上传、附件、数据导航按钮、分页导航按钮、流程条、登录用户和条形码这些单元格类型不支持设置命令。

## 单元格命令触发时机

文本框：失去焦点，并且内容文本框内输入内容发生变化时会触发命令。其他键盘输入框单元格类似，比如数字输入框。

单选按钮：选择项发生变化时触发（即每选择点击一次，就触发一次）。

多选按钮：选择项目改变时触发。

组合复选框：每个选项被选择或取消选择时触发。

链接：每次点击时触发。

组合框：每个项目被选中时触发。

日期：日期值选择值改变后触发。

图片：点击图片后触发。

按钮：按钮点击时触发。

## 表格相关命令



### 表格数据传递命令（插件）

[表格数据传递命令 - 葡萄城市场 (grapecity.com.cn)](https://marketplace.grapecity.com.cn/ApplicationDetails?productID=SP2104280010&productDetailID=D2206270027&tabName=Tabs_detail)

场景：将一个表格的数据传递到另外一个表格，可跨页面。

示例：....

## 图片命令

在活字格设计器中可以给单元格区域设置背景图片，选择背景图片在图片



## 逻辑控制命令

逻辑控制命令。

### 循环命令

使用循环命令，按照一定的循环方式对一个或一组子命令循环执行。循环方式分为按指定次数循环、按表格循环以及按单元格循环。



在循环命令中，循环方式为按单元格循环时， 需要指定基准单元，循环次数是基准单元格的个数。
在子命令中，如果有公式使用了相对引用，在循环过程中，公式引用的单元格会按照基准单元格进行偏移。



[帮你打开活字格更神奇的功能：三十六，循环表格批量赋值功能 - 活字格专区 - 专题教程 - 葡萄城产品技术社区 (grapecity.com.cn)](https://gcdn.grapecity.com.cn/forum.php?mod=viewthread&tid=46957&fromuid=51381)

### 条件命令

条件命令可以看做是一个组合命令，主要由**条件表达式**和**执行命令**组成。

条件表达式用来表示语句成立的判断逻辑，执行命令用来指定条件成立时要执行的操作。



## 编程命令

### JavaScript 命令

[编程命令-JavaScript 命令 - 活字格V8帮助手册 - 葡萄城产品文档中心 (grapecity.com.cn)](https://help.grapecity.com.cn/pages/viewpage.action?pageId=72354465)

利用 JavaScript 命令，编写 JS 代码，控制页面元素逻辑。

## 设置变量命令

[设置变量 命令 - 活字格V8帮助手册 - 葡萄城产品文档中心 (grapecity.com.cn)](https://help.grapecity.com.cn/pages/viewpage.action?pageId=72354611)

在活字格中，可以使用设置变量命令来设置变量，变量的值可以为值、公式，或是来自数据库。

## 设置行列布局命令

[设置行列布局命令 - 活字格V8帮助手册 - 葡萄城产品文档中心 (grapecity.com.cn)](https://help.grapecity.com.cn/pages/viewpage.action?pageId=72354578)

使用场景：用设置行列布局命令，可以**显示或隐藏整个行或列**，以调整页面的布局。

## 模板命令

在实际应用中，用户经常会定义一些复杂的命令或命令组，并且在多处使用。活字格提供了一个名为“模板命令”的特殊命令，用于命令的重用。

一个模板命令包括一个名称，一些参数和一个命令列表，用户可以自己定义这些命令。当用户需要使用模板命令时，只需要为参数赋值，即可**实现命令的“重用”**。



[模板命令 - 活字格 V8 帮助手册 - 葡萄城产品文档中心 (grapecity.com.cn)](https://help.grapecity.com.cn/pages/viewpage.action?pageId=72354536)

下面使用是模板命令封装 JS 函数的示例。

[利用模板命令实现封装 JS 函数，实现前端功能复用 - 活字格专区 - 格友杂谈 - 葡萄城产品技术社区 (grapecity.com.cn)](https://gcdn.grapecity.com.cn/showtopic-149052-1-5.html)



## 服务端命令

活字格中的服务端命令包括四个要素：名称、参数、命令和返回值。其中名称和命令为必要元素，参数和返回值为非必要元素。

调用服务端命令时，通过服务端命令的名称来调用，将页面端参数的值传递到服务端，服务端执行指定的命令，执行完成后将返回值到页面端。

[什么是服务端命令 - 活字格V8帮助手册 - 葡萄城产品文档中心 (grapecity.com.cn)](https://help.grapecity.com.cn/pages/viewpage.action?pageId=72357140)



无参数服务端命令

有参数服务端命令

有返回值服务端命令



### 服务端命令支持的命令

[服务端命令支持的命令 - 活字格V8帮助手册 - 葡萄城产品文档中心 (grapecity.com.cn)](https://help.grapecity.com.cn/pages/viewpage.action?pageId=72357483)



### 异常捕获命令

[异常捕获命令 - 活字格V8帮助手册 - 葡萄城产品文档中心 (grapecity.com.cn)](https://help.grapecity.com.cn/pages/viewpage.action?pageId=72358401)



### 调用存储过程



[存储过程调用 - 活字格V8帮助手册 - 葡萄城产品文档中心 (grapecity.com.cn)](https://help.grapecity.com.cn/pages/viewpage.action?pageId=72358307)

[MySQL 存储过程 | 菜鸟教程 (runoob.com)](https://www.runoob.com/w3cnote/mysql-stored-procedure.html)





> 服务端命令和前端命令？
>
> TODO ...
